<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Decision-trees/Tree-fitting" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Настройка решающего дерева | Онлайн-учебник по машинному обучению</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deepmachinelearning.ru/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://deepmachinelearning.ru/img/social-card.png"><meta data-rh="true" property="og:url" content="https://deepmachinelearning.ru/docs/Decision-trees/Tree-fitting"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="keywords" content="алгоритмы машинного обучения, методы прогнозирования, анализ данных, data science, machine learning, learn machine"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Настройка решающего дерева | Онлайн-учебник по машинному обучению"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://deepmachinelearning.ru/docs/Decision-trees/Tree-fitting"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Decision-trees/Tree-fitting" hreflang="ru"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Decision-trees/Tree-fitting" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Онлайн-учебник по машинному обучению RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Онлайн-учебник по машинному обучению Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.47723725.css">
<script src="/assets/js/runtime~main.f1acf5f2.js" defer="defer"></script>
<script src="/assets/js/main.b8c8749b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Машинное обучение</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Учебник</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/abbreviations">Обозначения</a><a class="navbar__item navbar__link" href="/license">Лицензия</a><a class="navbar__item navbar__link" href="/support">Поддержать проект</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Введение</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/основы-машинного-обучения">Основы машинного обучения</a><button aria-label="Expand sidebar category &#x27;Основы машинного обучения&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/подготовка-данных">Подготовка данных</a><button aria-label="Expand sidebar category &#x27;Подготовка данных&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/классификаторы-в-общем-виде">Классификаторы в общем виде</a><button aria-label="Expand sidebar category &#x27;Классификаторы в общем виде&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/метрические-методы-прогнозирования">Метрические методы прогнозирования</a><button aria-label="Expand sidebar category &#x27;Метрические методы прогнозирования&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/линейная-регрессия-и-её-обобщения">Линейная регрессия и её обобщения</a><button aria-label="Expand sidebar category &#x27;Линейная регрессия и её обобщения&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/оценка-качества-регрессии">Оценка качества регрессии</a><button aria-label="Expand sidebar category &#x27;Оценка качества регрессии&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/линейная-классификация">Линейная классификация</a><button aria-label="Expand sidebar category &#x27;Линейная классификация&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/многоклассовая-классификация-набором-бинарных-классификаторов">Многоклассовая классификация набором бинарных классификаторов</a><button aria-label="Expand sidebar category &#x27;Многоклассовая классификация набором бинарных классификаторов&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/численная-оптимизация">Численная оптимизация</a><button aria-label="Expand sidebar category &#x27;Численная оптимизация&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/оценка-качества-классификации">Оценка качества классификации</a><button aria-label="Expand sidebar category &#x27;Оценка качества классификации&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/решающие-деревья">Решающие деревья</a><button aria-label="Collapse sidebar category &#x27;Решающие деревья&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Decision-trees">Решающие деревья</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Prediction-specifics">Особенности прогнозов решающего дерева</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Decision-trees/Tree-fitting">Настройка решающего дерева</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Impurity-functions">Основные функции неопределённости при настройке правил</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Custom-loss-function">Учёт пользовательской функции потерь</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Tree-pruning">Обрезка решающих деревьев</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Missing-values">Обработка пропущенных значений</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Feature-importances">Важность признаков в решающем дереве</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Tree-benefits">Анализ решающих деревьев</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Decision-trees/Advanced-trees">Обобщения решающих деревьев</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/abbreviations">Обозначения в учебнике</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/решающие-деревья"><span itemprop="name">Решающие деревья</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Настройка решающего дерева</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><h1>Настройка решающего дерева</h1>
<p>Решающее дерево строится сверху вниз, начиная от корневой вершины, содержащей все объекты обучающей выборки. Сначала настраивается правило для корня, разделяющее эти объекты на две группы, первая из которых уходит левому потомку, а вторая - правому. Затем процесс расщепления вершин производится рекурсивно для каждой из образовавшихся вершин, как показано на рисунке:</p>
<p><img loading="lazy" alt="DT-construction.png" src="/assets/images/DT-construction-6b93b61f8dd249bf09ac26bfb9fc6fb2.png" width="1108" height="2020" class="img_ev3q"></p>
<p>Синим показаны внутренние узлы, в которых подбираются правила вида</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>признак</mtext><mo>≤</mo><mtext>порог</mtext></mrow><annotation encoding="application/x-tex">\text{признак}\le\text{порог}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord cyrillic_fallback">признак</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord cyrillic_fallback">порог</span></span></span></span></span></span>
<p>а красным - листовые вершины, в которых строится итоговый прогноз.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>подсказка</div><div class="admonitionContent_BuS1"><p>Обратим внимание, что правила в узлах одинаково хорошо работают и для вещественных, и для бинарных признаков. В последнем случае как раз образуются две ветки в зависимости от значения бинарного признака. Категориальные признаки можно закодировать через <a href="/docs/Data-preprocessing/Categorical-preprocessing#one-hot-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">one-hot кодирование</a>, тогда спуск по дереву будет осуществляться вправо, если категориальный признак равен определённой категории, и влево иначе. Если категорий много, то потребуется много сравнений, и всё равно не все значения категорий окажутся перепробованными. Поэтому для решающих деревьев рекомендуется <a href="/docs/Data-preprocessing/Categorical-preprocessing#%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D1%81%D1%80%D0%B5%D0%B4%D0%BD%D0%B8%D0%BC">кодирование средним</a>. Тогда при использовании образовавшегося признака объекты с высоким средним значением отклика пойдут вправо, а с низким - влево, что резко упростит прогнозирование для последующих этапов. Если объектов для каждой категории много, то даже не обязательно выделять под кодирование средним отдельную выборку - эффект переобучения будет небольшим.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="выбор-решающего-правила-во-внутренних-узлах-дерева">Выбор решающего правила во внутренних узлах дерева<a href="#выбор-решающего-правила-во-внутренних-узлах-дерева" class="hash-link" aria-label="Прямая ссылка на Выбор решающего правила во внутренних узлах дерева" title="Прямая ссылка на Выбор решающего правила во внутренних узлах дерева">​</a></h2>
<p>Чтобы задать решающее правило в каждом внутреннем узле дерева <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span> необходимо специфицировать, <em>какой именно признак с каким порогом сравнивать</em>. Для этого вводится <strong>функция неопределённости прогноза</strong> (impurity fuction) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>, характеризующая степень неопределённости откликов для объектов, попавших в соответствующий узел <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>. Примеры основных таких функций будут даны в <a href="/docs/Decision-trees/Impurity-functions">следующей главе</a>, а пока достаточно знать, что эта функция</p>
<ul>
<li>
<p>равна нулю, когда все объекты, попадающие в лист, выдают одинаковый отклик (в случае классификации - один класс)</p>
</li>
<li>
<p>тем выше, чем сильнее неопределённость в откликах (выше дисперсия для вещественных откликов, а в случае классификации - когда распределение классов ближе к равномерному)</p>
</li>
</ul>
<p>Для <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mtext>го</mtext></mrow><annotation encoding="application/x-tex">i-го</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord cyrillic_fallback">го</span></span></span></span> признака и порога <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> решающее правило <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>≤</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">x^i\le h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9606em;vertical-align:-0.136em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> разобьёт узел <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span> на два дочерних узла: левый <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">t_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> и правый <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">t_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. Если изначально в узле <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span> было <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> объектов, то они распределяться между левым и правым потомков в количествах <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">n_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> и <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">n_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>Тогда применение правила изменит неопределённость откликов в родительском узле <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span> на <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>n</mi><msub><mi>n</mi><mi>L</mi></msub></mfrac><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>L</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi>n</mi><msub><mi>n</mi><mi>R</mi></msub></mfrac><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>R</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{n}{n_L}\phi(t_L)+\frac{n}{n_R}\phi(t_R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1953em;vertical-align:-0.4453em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1953em;vertical-align:-0.4453em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> в дочерних, в результате чего получим общее изменение неопределённости</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mfrac><mi>n</mi><msub><mi>n</mi><mi>L</mi></msub></mfrac><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>L</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mfrac><mi>n</mi><msub><mi>n</mi><mi>R</mi></msub></mfrac><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>R</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta\phi(t)=\phi(t)-\frac{n}{n_L}\phi(t_L)-\frac{n}{n_R}\phi(t_R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Δ</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>Подбор признака и порога осуществляется так: мы перебираем всевозможные признаки <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">i=1,2,...D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span> и значения порога <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> (среди уникальных значений <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mtext>го</mtext></mrow><annotation encoding="application/x-tex">i-го</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord cyrillic_fallback">го</span></span></span></span> признака для объектов, попавших в узел <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>) и выбираем такую пару <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>i</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>h</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i^*,h^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, для которых достигается минимальная неопределённость в дочерних узлах или, что тоже самое, достигается максимальное изменение неопределённости при переходе от родительского узла к дочерним:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>i</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>h</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>i</mi><mo separator="true">,</mo><mi>h</mi></mrow></munder><mi mathvariant="normal">Δ</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i^*,h^*)=\arg\max_{i,h}\Delta\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6382em;vertical-align:-0.8882em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.3479em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">Δ</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Неравнозначность признаков</div><div class="admonitionContent_BuS1"><p>Стоит отметить, что в алгоритме вещественные признаки будут выбираться чаще, чем бинарные, поскольку для них больше уникальных значений порога, что даёт оптимизации больше гибкости подогнаться по порогу.</p></div></div>
<p>Сложность расчета <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>, как будет видно из следующей главы, имеет порядок <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, поэтому сложность подбора решающего правила равна <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>D</mi><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(Dn^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, пос кольку для каждого признака в качестве порога нужно перебрать его всевозможные уникальные значения, число которых не превосходит <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Более эффективный расчёт</div><div class="admonitionContent_BuS1"><p>Эту сложность можно снизить двумя способами:</p><ol>
<li>
<p>Перебирать не все возможные пороги, а только основные. В качестве таковых можно взять 10%,20%,...90% <a href="/docs/Data-preprocessing/Feature-normalization#p-%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D0%BD%D1%82%D0%BD%D0%B0%D1%8F-%D0%BA%D0%B2%D0%B0%D0%BD%D1%82%D0%B8%D0%BB%D1%8C">квантиль</a> в распределении признака. Тогда сложность подбора правила снизится до <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>9</mn><mi>D</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(9Dn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">9</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, поскольку мы будем перебирать всего 9 значений порога. Разумеется, можно брать и более детализированную сетку значений. Перебор по меньшему числу значений для вещественных признаков сделает более их сопоставление с бинарными признаками более равноправным и повысит ожидаемую глубину дерева, необходимую для точного приближения данных.</p>
</li>
<li>
<p>Предварительно отсортировать каждый признак. Это наложит дополнительные вычислительные расходы на сортировку, зато позволит более эффективно пересчитывать значения функций неопределённости за <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, поскольку мы будем знать, какой объект переходит из правой дочерней вершины в левую при каждом изменении порога без сканирования всех <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> объектов и сможем пересчитывать <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span> за <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, используя кумулятивные статистики. Итоговая сложность подбора правила по всем порогам тогда будет <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">(</mo><mi>n</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>n</mi><mo>+</mo><mn>2</mn><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>D</mi><mi>n</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(D(n\log_2 n+2n))=O(Dn\log_2 n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
</li>
</ol></div></div>
<p>Используя второй метод эффективного подбора правила, совокупная сложность построения всех правил на уровне <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> будет иметь сложность <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>D</mi><mi>N</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(DN\log_2 N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span></span></span></span> (поскольку все <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> объектов выборки проходят через один из  узлов на каждом уровне), а общая сложность построения дерева глубины <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span> будет иметь порядок <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>H</mi><mi>D</mi><mi>N</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(HDN\log_2 N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">HD</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span></span></span></span>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="остановка-при-наращивании-дерева">Остановка при наращивании дерева<a href="#остановка-при-наращивании-дерева" class="hash-link" aria-label="Прямая ссылка на Остановка при наращивании дерева" title="Прямая ссылка на Остановка при наращивании дерева">​</a></h2>
<p>При построении дерева сверху вниз необходимо решить, когда принимать решение об окончании дробления узлов и превращении текущего узла в листовой. Конечно, нет смысла продолжать разбиение, если все объекты текущего узла дают одинаковый отклик. В частности, это достигается, когда в листе остался всего один объект. Но также используются и досрочная остановка по одному из следующих критериев:</p>
<ol>
<li>
<p>достигнута целевая глубина <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></p>
</li>
<li>
<p>число объектов в узле меньше <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></p>
</li>
<li>
<p>число объектов в одном из дочерних узлов после оптимального разбиения меньше <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></p>
</li>
<li>
<p>неопределённость отклика в узле меньше порога <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">\phi(t)\le \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ε</span></span></span></span></p>
</li>
<li>
<p>максимальное изменение неопределённости при разбиении узла меньше порога: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">\Delta\phi(t)\le \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Δ</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ε</span></span></span></span></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="сравнение-критериев">Сравнение критериев<a href="#сравнение-критериев" class="hash-link" aria-label="Прямая ссылка на Сравнение критериев" title="Прямая ссылка на Сравнение критериев">​</a></h3>
<p>Досрочная остановка целесообразна, чтобы контролировать сложность получаемого дерева - чтобы его сложность соответствовала сложности реальных данных, иначе дерево, обученное до самого низа, станет переобученным и будет иметь плохую обобщающую способность на новых данных.</p>
<p>Критерии 2 и 3 близки по смыслу, однако критерий 3 предпочтительнее тем, что он, в отличие от критерия 2 гарантирует, что в каждом листовой узле будет достаточное количество объектов (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">\ge K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span>), чтобы делать статистически значимые выводы о прогнозе в листе.</p>
<p>Критерий 1 приводит в общем случае к построению сбалансированного дерева (расстояние от корня до каждого листа одно и то же), однако может оказаться неоптимальным с точки зрения числа объектов в листе - какие-то листы окажутся переполненными объектами, а какие-то - недозаполненными. Поэтому среди критериев 1,2,3 следует пользоваться третьим критерием.</p>
<p>Критерий 4 полезен, но реализуется нечасто - лишь для глубоких деревьев ближе к их концу.</p>
<p>Критерий 5 кажется максимально релевантным оптимизации, в котором мы стремимся минимизировать <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span> и досрочно прерываем процесс настройки, если видим, что не удаётся достичь существенного изменения в неопределённости. Однако тут стоит помнить, что остановка по этому критерию субоптимальна, поскольку в начале построения дерева мы можем видеть малое изменение неопределённости, которое может стать большим при более поздних разбиениях, как показано на рисунке для случая бинарной классификации, используя два признака:</p>
<p><img loading="lazy" alt="XOR-distribution.png" src="data:image/png;base64,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p92DDz7ofvjDH7rXve511bErr7zSPffcc+4f//iH+8hHPuKeeuopt7Gx4a644gp3ySWXVN8DwC4COFCAe++9133xi1+sX42cPn26+veWW26p/t27d6978skn3WOPPeZ27qRpAKzj/wMHCnXgwAH30EMPub/+9a9uz5499VEAqaCbDRTopZdecpubm+7qq69uFLwff/xx9453vMP95S9/qY8AGBoBHCjQI4884l544QV3ww031Eeme+CBB9wnP/lJ9/3vf79Krb/yyiv1VwAMjQAOFODvf/+7O3PmTP3KVSvOZXV1tfrXu+uuu6rFbt6HP/zh6rGyW2+9tT4CwAoCOJC5f/3rX1Wq/G1ve1u16lzLXu6///7qa1dddVX1rzz//PPu+PHj1dz4JJbKAPYQwIHM/elPf3Jnz551H//4x6vHw44ePVo9/33RRRe5J554ovoefV2r0Y8dO+Z27dpVHQNgGwEcyNy+ffvckSNHqkB+3XXXud27d7s777yzmt9WMNcnsh08eNAdPnzYXXPNNfVPAbCOx8gALKQV69dff33VCXjzm99cHwUwJEbgAAAkiAAOAECCCOAAACSIAA5gIf8BLvqvRwHYQAAHMJM+8EX/7egnPvEJt2PHDvfud7+7etzs1KlT9XcAGAqr0AEASBAjcAAAEkQABwAgQQRwAAASRAAHACBBBHAAABJEAAcAIDnO/T8dRAmgCGfu6AAAAABJRU5ErkJggg==" width="496" height="325" class="img_ev3q"></p>
<p>Изначальное распределение классов 50/50%, и какое бы разбиение вдоль какой бы оси мы ни выбрали, оно примерно таким и останется, поэтому изменение неопределённости <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>≈</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Delta\phi(t)\approx 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Δ</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>. Однако, если бы мы не останавливались, а стали бы производить последующие разбиения, то мы могли бы прийти к 100% точности прогнозов.</p>
<p>Из-за этого, для достижения максимальной точности прогнозов, рекомендуется строить дерево до самого низа (пока объекты в каждом узле не станут иметь одинаковый отклик), а потом производить <strong><a href="/docs/Decision-trees/Tree-pruning">обрезку лишних ветвей</a></strong> (decision tree pruning). Что, впрочем, не отменяет досроч ную остановку по критерию 3, чтобы в обеспечить в каждом листе минимальное количество объектов для построения статистически достоверных прогнозов.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="назначение-прогноза-в-листах">Назначение прогноза в листах<a href="#назначение-прогноза-в-листах" class="hash-link" aria-label="Прямая ссылка на Назначение прогноза в листах" title="Прямая ссылка на Назначение прогноза в листах">​</a></h2>
<p>Как только принято решение об остановке процесса построения дерева, текущий узел дерева превращается в листовую вершину, и ей нужно назначить прогноз. Для этого используют простые правила:</p>
<ul>
<li>
<p>в задаче регрессии можно назначить среднее или медиану откликов объектов, попавших в узел.</p>
</li>
<li>
<p>в задаче классификации в качестве прогнозной метки класса назначают самый часто встречающийся класс, а если нужно выдавать распределение классов, то выдают распределение откликов среди объектов, попавших в узел.</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Настройка на определённую функцию потерь</div><div class="admonitionContent_BuS1"><p>Если пользователь минимизирует свою функцию потерь <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\hat{y},y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span>, то эффективнее назначать такой прогноз в листьях дерева, который будет е ё минимизировать <a href="/docs/Decision-trees/Custom-loss-function#%D0%BB%D0%B8%D1%81%D1%82%D0%BE%D0%B2%D1%8B%D0%B5-%D0%BF%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D1%8B-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%BE%D0%B9-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8-%D0%BF%D0%BE%D1%82%D0%B5%D1%80%D1%8C">напрямую</a>.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Decision-trees/Prediction-specifics"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Особенности прогнозов решающего дерева</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Decision-trees/Impurity-functions"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Основные функции неопределённости при настройке правил</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#выбор-решающего-правила-во-внутренних-узлах-дерева" class="table-of-contents__link toc-highlight">Выбор решающего правила во внутренних узлах дерева</a></li><li><a href="#остановка-при-наращивании-дерева" class="table-of-contents__link toc-highlight">Остановка при наращивании дерева</a><ul><li><a href="#сравнение-критериев" class="table-of-contents__link toc-highlight">Сравнение критериев</a></li></ul></li><li><a href="#назначение-прогноза-в-листах" class="table-of-contents__link toc-highlight">Назначение прогноза в листах</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 Виктор Китов.</div></div></div></footer></div>
</body>
</html>