<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Neural-networks/Recurrent-neural-nets/Architectures" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Архитектуры | Машинное и глубокое обучение</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deepmachinelearning.ru/img/social-card2.png"><meta data-rh="true" name="twitter:image" content="https://deepmachinelearning.ru/img/social-card2.png"><meta data-rh="true" property="og:url" content="https://deepmachinelearning.ru/docs/Neural-networks/Recurrent-neural-nets/Architectures"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Архитектуры | Машинное и глубокое обучение"><meta data-rh="true" name="keywords" content="типы рекуррентных нейронных сетей,рекуррентные нейронные сети применение,архитектура рекуррентной нейронной сети,рекуррентные сети,rnn,сети rnn,рекуррентные нейронные сети,рекуррентные сети rnn,сети рекуррентного типа,recurrent network"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://deepmachinelearning.ru/docs/Neural-networks/Recurrent-neural-nets/Architectures"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Neural-networks/Recurrent-neural-nets/Architectures" hreflang="ru"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Neural-networks/Recurrent-neural-nets/Architectures" hreflang="x-default"><link rel="preconnect" href="https://mc.yandex.ru">
<script>!function(e,t,a,c,n,r,i){e[n]=e[n]||function(){(e[n].a=e[n].a||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(a),i=t.getElementsByTagName(a)[0],r.async=1,r.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(r,i)}(window,document,"script",0,"ym"),ym(98444042,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!1,ecommerce:!1,trackHash:!1})</script>
<noscript>
                            <div><img src="https://mc.yandex.ru/watch/98444042" style="position:absolute; left:-9999px;" alt=""></div>
                        </noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.8f598318.css">
<script src="/assets/js/runtime~main.10620c13.js" defer="defer"></script>
<script src="/assets/js/main.0773afd7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/Machine-learning/book-title">Машинное обучение</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Neural-networks/book-title">Глубокое обучение</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/abbreviations">Обозначения</a><a class="navbar__item navbar__link" href="/license">Лицензия</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Neural-networks/book-title">Глубокое обучение</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Neural-networks/intro">Введение</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Tasks-of-deep-learning">Примеры задач глубокого обучения</a><button aria-label="Expand sidebar category &#x27;Примеры задач глубокого обучения&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Multilayer-perceptron">Основы нейросетевых архитектур</a><button aria-label="Expand sidebar category &#x27;Основы нейросетевых архитектур&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Training-neural-networks">Обучение нейросетей</a><button aria-label="Expand sidebar category &#x27;Обучение нейросетей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Training-simplification">Упрощение настройки</a><button aria-label="Expand sidebar category &#x27;Упрощение настройки&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Regularization">Регуляризация при настройке нейросетей</a><button aria-label="Expand sidebar category &#x27;Регуляризация при настройке нейросетей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Special-architectures">Специальные архитектуры</a><button aria-label="Expand sidebar category &#x27;Специальные архитектуры&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Convolution-for-sequences-1D">Локальная обработка последовательностей</a><button aria-label="Expand sidebar category &#x27;Локальная обработка последовательностей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Convolution-for-images-2D">Локальная обработка изображений</a><button aria-label="Expand sidebar category &#x27;Локальная обработка изображений&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Convolutional-architectures">Основные свёрточные архитектуры</a><button aria-label="Expand sidebar category &#x27;Основные свёрточные архитектуры&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Semantic-segmentation">Семантическая сегментация</a><button aria-label="Expand sidebar category &#x27;Семантическая сегментация&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Object-detection">Детекция объектов</a><button aria-label="Expand sidebar category &#x27;Детекция объектов&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Instance-segmentation">Сегментация объектов</a><button aria-label="Expand sidebar category &#x27;Сегментация объектов&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Embeddings">Эмбеддинги слов и параграфов</a><button aria-label="Expand sidebar category &#x27;Эмбеддинги слов и параграфов&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/Neural-networks/Recurrent-neural-nets">Рекуррентные сети</a><button aria-label="Collapse sidebar category &#x27;Рекуррентные сети&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/RNN">Рекуррентная сеть</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/Generative-RNN">Рекуррентная сеть как генератор</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/Iterative-generation">Итеративная генерация</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures">Архитектуры</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/Extensions">Расширения</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Neural-networks/Recurrent-neural-nets/LSTM-GRU">LSTM, GRU</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Transformer">Механизм внимания и трансформер</a><button aria-label="Expand sidebar category &#x27;Механизм внимания и трансформер&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Neural-networks/Graph-processing">Обработка графов</a><button aria-label="Expand sidebar category &#x27;Обработка графов&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Neural-networks/conclusion">Заключение</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Neural-networks/Recurrent-neural-nets"><span itemprop="name">Рекуррентные сети</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Архитектуры</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><h1>Архитектуры</h1>
<p>Рекуррентная сеть способна работать в разных архитектурах, решающих различные задачи. Для графического описания каждой схемы будем использовать следующие условные обозначения:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/definitions-ca01d0827b939b33e92313d31c50534d.png" width="916" height="759" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="synchronized-many-to-many">Synchronized Many-to-Many<a class="hash-link" aria-label="Прямая ссылка на Synchronized Many-to-Many" title="Прямая ссылка на Synchronized Many-to-Many" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#synchronized-many-to-many">​</a></h2>
<p>Синхронизированная many-to-many (synchronized many-to-many) представляет собой классический случай применения рекуррентной сети, описанный ранее. В этой архитектуре по каждому входу <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> строится соответствующий выход <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, по которому сразу можно посчитать функцию потерь <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\hat{y}_t,y_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. Потери от обработки всей последовательности считаются как среднее от потерь на каждом её элементе:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mover accent="true"><mi>Y</mi><mo stretchy="true">^</mo></mover><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\widehat{Y},Y)=\frac{1}{T}\sum_{t=1}^{T}\mathcal{L}(\hat{y}_{t},y_{t})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1733em;vertical-align:-0.25em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span><span class="svg-align" style="top:-3.6833em"><span class="pstrut" style="height:3em"></span><span style="height:0.24em"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8829em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p><strong>Примеры использования:</strong></p>
<ul>
<li>
<p>синхронная разметка частей речи,</p>
</li>
<li>
<p>синхронная обработка фреймов видеопотока,</p>
</li>
</ul>
<p>когда нужно сразу по известной входной последовательности сгенерировать её обработку.</p>
<p>В приведённых выше обозначениях эта схема будет выглядеть как</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAncAAALoCAYAAAAa+tP0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAOF3pUWHRteGZpbGUAAFiFTVjVruxKj36aJc1cnK0wXIahw5y+GYWZOU8/yV7n14zUUO1yuY1f2fmBme7Mqzb7gYByWNYfmP2BIK7NknUe+mf50LshrfIqS3/3IACC/gGIfyDAAeEfmALx5wNG/qAI8f3lj4qs/1cQ+gd4CP8VgOAPTD8rpeq38/k+Cex/MOS/nxU1jm3mZ/GnWn8gHoXxPzD2HvmIjqr8QMyzbqvmVU/IkmZ4j6RzdPyphocdhP8Af+CHxJTz0D1MPAG8FJLA/4DYu/F/lvDEH+gP+JDsKI/m6v/92atztkbFr8r7lXzRcQBg6x+orHzwlEf6l2fP5qV6RP1l+89fvxvrNWa/1DTbqyR7qTD3AzNpFRVz1D0s1b/eY3zGJda5gmm2mkGtIdT2/hXSR92/QozHgf+Av0JwD46TTYW4HYiMe+QDrqJqnLsbDE5lZfMmd4Bq3OQuYGwAN3BCeHssy6tOASm/QErMMiX1MCiiNieTSzMV2Aoiqs0VyvOH8QpBl4ANMLnXYCqq+G6PHToOv60/1kiQPxDdoUEQm7u0QHG4TJtPxOkC5/zjUNrBfQ32QePCW8xQplNZVm8PDiQeLw/D/Qh009XyfO8mMhj+RjMCkeSHjlftivHyCQB9h5OvQjCa39uGx9GqPtbT+PMuwWHD53GXmx6/e9iC0wMyNMQjHpUVdJBacuvYwPN6HwJzWCHTaf3ymYzma4KSxq7ss/8JfC2z6ddIGB9BYseI9/Tz2r9oX8NEusNj/3iZ3i/GDyDkTQh/ujKofVYJOX9fXVzLbN3n97ylI2H3Cj2P+N7OAUa0rKptj0RaA8cd2vDpWYLebX2nYCV2D5vHpE2DeHnIp3+v1gLO5puxbYC294igQNQZHAjhsMO0LqhAl+eB2dyiEtHqJwcVT93QHolNWzCuMVSk3Oc5bUGQ2j8BpvtuN0kEgi1oerLIB0wsPjPMIVF5DWbnKRre/NLjJavm10h0oBH1yfwSLmwLORYq4274axhXKd3I6lZWTmssqrssBcsrcguHc0h0W8Y3c0aGC9q5K5zUlREYhqfNtcyLOAp9a6TKLRV0zE/66HOUSi5r4D19hiDsIvoaJ6cHnNQ3XEBwyX3W6FLMbmniSn0hOWYnuDhouTdXxdmWUVwGO8FA7BUSvNfQ2FBElpBWRpvPHXLSqK67t77p6zt0m59dcmV8MeCodQZB1+mS4zBkHzbs5cnoWfAHNVzOuc8ITZ4OIUY04dXTA3fgyWqeFdPcWw8THUwYsLQDdQA59zSAcvKUryzNyPWHG2No/4UZV38rgUXcPTr6qSQ4WC0/jAK5XUbFWNPZfKB5D8egvEnQ+qkHo5Gc8NhqPAQyevzZ709e892oPD+zJynpEdsn8HaKud/my6f36eu9IPUoyRtICrU46eZ4+N0DAz+SYD7f1KX3Dj0RYlV64lVrI+4keKhLnM343K84uRPTowIf+LbOElMXTTERt+mOY5McTcZAsoSaUKgX8XlwYQ9CQfw5ZPo3s5sOfjWt9Tt+F4/yLZCvwm/BWL18adxH+TJvTXyp1xkjAyMVVeSqeCAci/TlQMUPma86fovGpjcy+iTlmCziXI2oygoVVRrIOzMt+ZFIj/LAMbTljrJquB+ndzHuAWL+rf0ecD+qyNRYCRAgB/YRl1RHOmIFtpbwNoiDk9WhjiU9dgez+hXCFWeFViDgxva58yPZ9iOoFQuG+/gJ2ScZbWGINO8POMqeKGK6meAfy8SpUsU3knBmFgbMJUGn/sHg5KNjnTL4UT0oTWSkjN4cMmWbXGkFcs6mFfL5TJbdmxpXgmYkBS40MnVYAYlWCo0ZzNdjQTLA++lpLtf1E0RxNzaXWU4zyTZiCkLxUNGSBNaAoEAlmG5RGKv5zoCKTfIRa5YPxHU1GlcBwS7ouzk2Cj1yLSkxB46T3NY1pq1uVxbQjIMwYJWuDOAFNhRSuwJASO5MMDF81OCX7OsdbaZHNrnjgceRdXtjaM9xIpZ/18dRDNPpwlScEOaSLiOAM36PDPZFCB4jLPc8Jz4zhLN8sPuCvDc8u5YEMNb3R3ajS1jkny3TMNI5pHuFQyM76EySjJYIOea28mLTGdmPLp2kz6vlQVG09JrDLvlUvsaVyNgye6AMqJHGxIMZkYaOT8W2AfZJIvmFck4aD6+lJ8jHti24Yb5pk90LmKBTi/mAbyu7R/XRithVxMyILHIDUZiRgx5eaQ2yHEk3VgismHnIukgRYKg3MVQUlE4DHJlrMjVP5akqSi4VXJfz0uCNXV1rwyJ9lajz/eL2qC42z17Ckw0q1orYFYqg2SGj6frBmrhBYkMcS7p8fEMV6ADqG0h+rN4NCdJ8KpSmVM2eYl1eeHDmi4kddL168re1hKyZVx2BP8tGB7caP0Gxdg+J5xCsM+gFquHx9aEG82euX0kuHXvmU348QjN2oVkJFy0AH/pSq0rGEHfJJ9D9gWyV0NgLL31NWYLi+MBZYh5hOmkLMKwqE5kS7FkaxYP9hxRKExubAuu+A6TXpV7YJ0pDVl0UE7Y1igTovkeu4ltO6tY18ALpq+CUcKjBYfpebGT4IgEC+YGbCBQbI6bGdG4YCuVcN1VRVKrsqBvBHD64GQjbsIYsU0eoRoIYpz37ZNr63okEZeZJSMh8VzPDYvIMNNrYYn/VmdET0taExyhLQZ8MpJHEQ0qhelHeQVQLk+MlpDxOkJvz8mrZdqpMIzsKKpN45e5v5axzRsPTtLxA3PbK/om/n0vVbc2ADyNXv+FkWAQZmHHzXtTf86M3oKMm50hWfN0K3+kJc5FPtscRkLUnLYGWs0HRLk8Nk6dkNQZFxaDLWFFS2ERV8kRP1KerIFvCsPhmjAxQRYyuojI8lTjzoQVl01jkLm0QKxo6UYVbcIqFTaaGEMpbt+26/sKuGY5XXQ1QGnBOfolZTtHo1BbBCiVkrkWxznsyiessioT7/Kj+XntUeaUUOjrP8ft2qkkm/m7w1/EXx+ltNQkLag88eUFK3ydOeeAEoFOHGqIivioHlN4j+bcyUbokgVpEYi1Dk+K5kmn7BnCD60/AymGnIGmYZNxCxIEu3WjBxolYUzNnYwLTHXM9DPPqa+SUUVlpWWL9Fp0YloG8zjNXur6NumDek49u1iU9srmmIK01oZgRBVc80dqTRcgqdkfLY5CxkZzVUpsMbAA1qThdzPGWsnMK9zqOncZaoHbXSb8KPGOKA8u0WMJY2ACVIet0QHOmkx7rZxDKlBYxFNubt6Ejzg2ouwOm3qzqY5LBMAqRWAd9Cwca9cFvnVKXhIR1BmKAOV13YxGsUxlIi950l4gLPSE4qFvbahhMPSIYj4PQhQt+20xasNYypDp//NwxlxcoqhqXxBmN/FxONHE4HgLua5XFPNln+nYP1oWpuLC17IjSh1XPjmi3ovT2rixte5J0Q4aEg2Qxv7EtP77lDEYv+5BOfhCz3TMuJ3OrynUXqOuSe43ovxo3C4NUME1oKk928980cCpGnTQXTQiTZw94jYZKEnzA5tT27WTbife7Ecco6hkIRryc1vYchD5z3sYrRp8LuEBqXY8lyZvqg+HrUi6P96BTZJOeVwzw0Sc+vuDmw/nog9ypNqBwuenHvYrLvmGYKCTFRens4iLK2NMh8UR2gRAuyAPApVIb+wZAksKK2B9FXHqhJDjzXW6hirFzuWrbF1exQjjksSTQL19TzRs++5miWC+nmBqtFmzsEsoWb7E8oVNIXsPlT6u3X4tGuYRpJ5pNQfrjcjXDJswHnzHVtE4jWGSaML/ccCUVfdAUsB7PiASn+i2h/CwRNBSFvUuWHR4PKHVJt63sZYyQOgKwDZfsLBjzd2XMHjlMSIyM+HAqgMEoH0IkQQ020dsJLVTiZ2X1qbRKQ8nrD3POXASQ+YF9exafIvnu+JLmi1Wh2w2cvBRXkCVoxTlHHy0hiQbz6yd4iL5Y7qwl1GwwdqyXui2KXmOE+jZXRa2wNJqBOkDp37WzQQPqATGYC/9v4TeeFacZ8vS3fD2BCtEv0M6xax0XkI2apIPSmwj35BnbX+aOh8h3gk0JygRjAtyNQK+iPKy5YMP+3uIXQLqYrQoktFaOlkD2vrF4O815+PgahxgyeSyWEoqxxd1BDTVtmUEcp4G1nHKIbXiFdQQq7vUcH1SItfGXsShggrSd5gdWciVdgutJzdgshWozYIeMAx9WT8Vmr2gcRe1E6LILYH5iRzUKoJBvdW6l/U4SESkZvnvy4CMp/RrdWOczGQN3px069F8v3EWREB6aCBzFA+xANTrdxF2WT3o9npTe9oJRUBJvCkk2cotp3pVazIrzUUFh3mBEtIDmzBQ6UuwK+vhlU8U9iuX2LYZwt154YJfaAvHR3obrU0zlaE1RTEaVIaHRGebpL2Qnb8+c3O9EQkFRhoRkAEnQp4hSNajN9uiR5umZbeidCphi6RfADmyZJI4u3jqy1yZPNz5bnH3KZ2R8B4xt2Xf4SDbSoCTNA5qJjXub0p+vhcGxvRt3RXvgjzameUomcm+3Uuwggpi7ipzpbUYYvhohcnoR8ksOXc6R9n3hX4sUD5K4pAzpvFrVF4MuHinyIpfEDh6gQYZJiAHXaddIKovyil33Fiz027A4um4Y+zmG83yjnkE2SfQOeNuK1wE8cQUFLBk858xCoVx1ofOMkgdFjfvqTEnWg0lCFzI6QMez/0DqOgPp0+kxRuzAeYbqCDnnr7b9VXurYow1Oh64lsPat32al027X9epF94TGwqt95kf7zOW9/UOyf95PvP3Yc07n/0+CoO5/wWtqBzNLfVfVwAAFGtJREFUeJzt3cFr3/d9x/GPnN81IIJXyNKS5tDA1h5MNtghpP7l1B7skcNODQOdmr9i6Ed3HtG5FBrR9jJ28GEDQwjJrZTC6GFrAznkZ9N6K5QhCi0taGgHI6+OZUt2ftJXv+fv8QBDYpnkTfLyN89vpMRbR0dHRwMAgIQrUx8AAMDqiDsAgBBxBwAQIu4AAEJmUx8AT/I///kfU59w6b3w1a9NfQJnZM+ns+f1Yc+nm2rP4o5L76eLf5j6hEvrha9+zT8M14w9P549rx97frwp9+zTsgAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgxC8/Rsr2yy9PfcLndnDnztQncEnYMyX2fHHEHTnX3v77qU94Zgd37oyf3fnB1GdwidgzJfZ8MXxaFgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQMhs6gNg1Q7u3Jn6BFgZe6bEni+GuCPl4M6d8bM7P5j6DFgJe6bEni+OT8sCAISIOwCAEHEHABAi7gAAQsQdAECIuIOn8E8//ffx69/9fuozYCXsmRJ7/n/iDs7o17/7/Xj/zt3xw59/PPUp8LnZMyX2/DBxB2d0/NB4/85db4esPXumxJ4fJu7gDI7fCscY47mtLW+HrDV7psSeHyXu4Ax++POPx3NbW2OMMf736MjbIWvNnimx50f55ce49F746tcm/fP/18HBeP9fbj30fc9duTL++d5/j923/naiq1hX9kyJPV9OW0dHR0dTHwGX2c7OzvjRj340Dg8PH/nYp59+Or785S9f/FHwjOyZEns+mbiDJ1gul+OVV1458WOz2Wy8/fbb47333rvYo+AZ2TMl9vx44g6e4Elvhcc2+e2Q9WLPlNjz44k7eIzPvhXOZrNHHiKb/nbI+rBnSuz5yfzXsvAYi8VijDHGlSv3f5q8/vrrY4wx5vP5eP7558cYYxweHo79/f2xXC6nOBHOzJ4psecnE3dwguVyOfb398cYY7zxxhvjww8/HB999NEY4/7D4+7du2N3d/fBQ+T4QQOXkT1TYs+nE3dwgsViMa5fv/7goTGfzx/6+Pb29lgsFg8eIrdu3drIt0PWgz1TYs+nE3dwgp2dnRMfGp91/BBZLpfj4ODgYo6Dp2TPlNjz6cQdnOC0h8ZnbW9vj2vXrp3PMfA52TMl9nw6cQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCZmf5QR9/b+u877h0rr62GFdf2536DACAp3KmuBtjjKtf+fZ53nGp/OaT7059AgDAMzlz3I0xxtVXNyPwxB0AsK58zR0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAjZOjo6OjrtB338va1x9SvfHldf/fZF3DS5j//tr8fV1xbj6mu7U5+S9s4770x9wsa4efPmuHHjxtRnpNnzxbHn82fPF+c89jxb6R8NntI3v/nNqU/Iu3379tQnbAx7Pn/2fHHs+fyd157FHZP7xje+MfUJaf5heLHs+XzZ88Wy5/N1Xnv2NXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxx0rs7OyM/f39qc+AlbBnSux584g7VmJnZ2fs7OyMl19+2UOEtWfPlNjz5hF3rMR8Ph/Xr18fd+/e9RBh7dkzJfa8ecQdK7NYLB789r179zxEWGv2TIk9bxZxx8ocvx3OZrNxeHg4xvAQYX3ZMyX2vFnEHSu1WCwePDjGGB4irDV7psSeN4e4e4zFYjG2trZ8e8pvb7755hhjjOeee+6hv57HD5Ff/vKXY2dnZ7zyyivj3r17F/73dVPZ8/nvmYtjz/bMk82mPuCyms/n48/+aj71GWvnD3/4w3j33XfHH//4x0c+dvzpgC996Utjd3d3/PjHP57gws00n8/HzZs3pz5j7djz5WTPz8aeN4e4e4z5fD7+7rXdqc9YO4vF4pEHx/FD48UXXxzf+c53xs7OzhhjeHhcoPl8Pm7cuDH1GWvHni8ne3429rw5fFqWlTk4OBjvvvvug9+fze6/O7z44ovj+9///oP/DB/WgT1TYs+bRdyxMnt7e+O3v/3tuHLl/qw8NFhn9kyJPW8Wn5ZlJQ4ODsbe3t4YY4yXXnrpoX+9D+vGnimx580j7liJvb29sb29Pfb29jw0WHv2TIk9bx5xx0pcu3ZtLJfLqc+AlbBnSux58/iaO1birbfemvoEWBl7psSeN4+4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEzKY+gM12+/btcfv27anPgJWwZ0rseX2JOyZz8+bNqU94ant7e+Nb3/rW+MIXvjD1KVwy9kyJPa83ccdkbty4MfUJT2W5XI4PPvhgfPGLXxzvvffe1OdwydgzJfa83nzNHZzRYrEYY4yxv78/lsvlpLfA52XPlNjzw8QdnMFyuRz7+/tjjDFms9mDBwmsI3umxJ4fJe7gDBaLxZjN7n8Vw+HhobdD1po9U2LPjxJ3cIrjt8LDw8MH3+ftkHVlz5TY88nEHZziT98Kj3k7ZF3ZMyX2fDJxB09w0lvhMW+HrBt7psSeH0/cwROc9FZ4zNsh68aeKbHnxxN38BiffSs86SGy6W+HrA97psSen0zcwWMcPxSuXLn/0+T1118fY4wxn8/H888/P8bwdsj6sGdK7PnJxB2c4E//v0lvvPHG+PDDD8dHH300xrj/8Lh79+7Y3d198BDZ1LdD1oM9U2LPpxN3cILFYjGuX7/+4KExn88f+vj29vZYLBYPHiK3bt3ayLdD1oM9U2LPpxN3cIKdnZ0THxqfdfwQWS6X4+Dg4GKOg6dkz5TY8+nEHZzgtIfGZ21vb49r166dzzHwOdkzJfZ8OnEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAhs7P+wN988t3xm0++e563AADwOZ0p7q6+tjjnMwAAWIUzxt3ued8BAMAK+Jo7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIGTr6OjoaOoj4Gn947++M/UJF+7rr94c11+9MfUZnAN7psSepzeb+gB4Vn/x0t9MfcKF+cWvfjL1CZwze6bEnqcl7lhrf/nnm/EAuYwPD1bPnimx5+n4mjsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AIAQcQcAECLuAABCxB0AQIi4AwAIEXcAACHiDgAgRNwBAISIOwCAEHEHABAi7gAAQsQdAECIuAMACBF3AAAh4g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhIg7AICQ2dQHwLP6xa9+Mn7xq59MfQashD1TYs/TEnespa+/enPqE2Bl7JkSe57e1tHR0dHURwAAsBq+5g4AIETcAQCEiDsAgBBxBwAQIu4AAELEHQBAiLgDAAgRdwAAIeIOACBE3AEAhPwfFiyAGnEM61kAAAAASUVORK5CYII=" width="631" height="744" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="many-to-one">Many-to-One<a class="hash-link" aria-label="Прямая ссылка на Many-to-One" title="Прямая ссылка на Many-to-One" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#many-to-one">​</a></h2>
<p>В архитектуре many-to-one на вход поступает последовательность, для которой в целом нужно произвести однократный прогноз.</p>
<p><strong>Примеры использования:</strong></p>
<ul>
<li>
<p>анализ тональности (sentiment analysis), когда по текстовому отзыву необходимо понять, положительный он, отрицательный или нейтральный;</p>
</li>
<li>
<p>классификация текста по темам, например, классификация новостей по рубрикам &quot;экономика&quot;, &quot;политика&quot;, &quot;спорт&quot; и т.д.;</p>
</li>
<li>
<p>прогнозирование временных рядов: по всей последовательности предыдущих наблюдений предсказать следующее, например, для задач метеорологии (предсказать завтрашнюю температуру) или алгоритмической торговли (предсказать завтрашние цены на акции);</p>
</li>
<li>
<p>распознавание заболеваний: например, по временным данным сердцебиения определить, болен пациент или здоров;</p>
</li>
<li>
<p>классификация видео по категориям; в этом случае видео представляется как последовательность фреймов, а катег ориями могут выступать &quot;новости&quot;, &quot;образовательный контент&quot;, &quot;развлекательный контент&quot; и т.д.</p>
</li>
</ul>
<p>Реализовать many-to-one архитектуру можно двумя способами.</p>
<p>В простейшем случае можно считывать выход сети для всех последовательности <strong>только на последнем шаге обработки последовательности</strong>, а предыдущие выходы сети просто игнорировать.</p>
<p>Тогда <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> представляет собой</p>
<ul>
<li>
<p>либо вещественный прогноз (для регрессии),</p>
</li>
<li>
<p>либо <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> рейтингов классов (в задаче классификации), которые потом пропускаются через SoftMax преобразование.</p>
</li>
</ul>
<blockquote>
<p>Эта схема хорошо работает для коротких последовательностей либо для последовательностей, у которых лишь по итогу всей её обработки можно делать выводы.</p>
</blockquote>
<p>Можно поступить сложнее и трактовать <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> как вектор эмбеддинга всей последовательности, а окончательный прогноз строить как преобразование над этим эмбеддингом, например, многослойным персептроном <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">MLP(\hat{y}_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>Альтернативная many-to-one архитектура заключается в том, что мы <strong>считываем выходы сети для каждого шага обработки последовательности</strong>, а потом <strong>агрегируем прогнозы сети</strong> некоторой функцией агрегации:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mtext>aggregate</mtext><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mn>1</mn></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>T</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{y}=\text{aggregate}(\hat{y}_1,\hat{y}_2,...\hat{y}_T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">aggregate</span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>В качестве агрегации можно использовать усреднение или взятие поэлементного максимума.</p>
<blockquote>
<p>Эта схема более предпочтительна, когда обрабатываются длинные последовательности, а характерные признаки, существенно влияющие на результат, могут встречаться в любом месте последовательности.</p>
</blockquote>
<p>Полученный эмбеддинг, как и раньше можно трактовать как окончательный прогноз, либо как эмбеддинг последовательности, над которым необходимо произвести дополнительную обработку.</p>
<p>Графически оба подхода показаны ниже:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/many-to-one-d383396e630956f3d05755227e36baa1.png" width="1585" height="1038" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-to-many">One-to-Many<a class="hash-link" aria-label="Прямая ссылка на One-to-Many" title="Прямая ссылка на One-to-Many" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#one-to-many">​</a></h2>
<p>В архитектуре many-to-one нужно по вектору фиксированного размера, кодирующему запрос (т.е. по эмбеддингу запроса) нужно сгенерировать последовательность.</p>
<p><strong>Примеры использования:</strong></p>
<ul>
<li>
<p>написать музыку в заданном жанре (жанр задаётся эмбеддингом, например кодировкой one-hot, а музыка - последовательность нот);</p>
</li>
<li>
<p>описать текстом, что изображено на фотографии (фотография пропускается через свёрточный кодировщик, выдающий эмбеддинг фотографии)</p>
</li>
<li>
<p>сгенерировать видео по начальному фрейму (фрейм также задаётся эмбеддингом из свёрточного кодировщика)</p>
</li>
</ul>
<p>Применения: описание изображений (image captioning), генерация текста по теме, генерация музыки определённого жанра, ответы на вопросы по картинке (visual question answering).</p>
<p>В простейшем случае эмбеддинг запроса подаётся как начальное внутреннее состояние <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">h_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> рекуррентной сети, генерирующей выход (генератору). Первым входом генератору подаётся эмбеддинг токена [SOS] (start of sequence).</p>
<p><img decoding="async" loading="lazy" src="/assets/images/one-to-many-7fadf715945b84eda4a2f42662bbc4ac.png" width="1523" height="812" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="many-to-many">Many-to-Many<a class="hash-link" aria-label="Прямая ссылка на Many-to-Many" title="Прямая ссылка на Many-to-Many" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#many-to-many">​</a></h2>
<p>Many-to-many называется также seq2seq и encoder-decoder и применяется для преобразования входной последовательности в выходную.</p>
<p><strong>Примеры использования:</strong></p>
<ul>
<li>
<p>машинный перевод (вход: предложение на исходном языке, выход-предложение на целевом)</p>
</li>
<li>
<p>чат-бот, система автоматических ответов на вопросы (вход: вопрос пользователя, выход: ответ системы)</p>
</li>
<li>
<p>распознавание речи (вход: последовательность звуков речи, представленная в виде спектрограммы, выход: распознная речь в виде текста)</p>
</li>
<li>
<p>генерация речи (вход: некоторый текст, выход: озвучивание этого текста в виде спектрограммы)</p>
</li>
</ul>
<p>Реализуется эта архитектура двумя рекуррентными сетями, называемыми кодировщиком (encoder) и декодировщиком (decoder). Кодировочная сеть проходит по входной последовательности и кодирует её в виде эмбеддинга. Эмбеддингом могут выступать выход кодировщика или его внутреннее состояние в последний момент времени. Либо некоторая агрегация от выходом (усреднение, поэлементный максимум). Полученный эмбеддинг задаёт вектор контекста, по которому декодировщик выдаёт результат обработки. Этим вектором можно инициализировать начальное состояние декодировщика либо конкатенировать его ко входу декодировщика в каждый момент времени, как показано ниже:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/many-to-many-d483c6a279b1ba15ebc62019466b4686.png" width="2908" height="994" class="img_ev3q"></p>
<p>Второй способ более предпочтительный, если на выходе ожидается длинная последовательность. Для её генерации потребуется много шагов, из-за чего кодировщик может &quot;забыть&quot; исходный контекст, если его передавать только как начальное состояние. Чтобы он его не забыл, полезно напоминать контекст на каждом шаге генерации.</p>
<p>Можно объединить оба подхода:</p>
<ul>
<li>
<p>начальное состояние декодировщика инициализировать последним состоянием кодировщика (если размерности не совпадают, то можно преобразовать линейным слоем),</p>
</li>
<li>
<p>а последний выход кодировщика задаёт контекстный вектор, конкатенируемый к каждому входу декодировщика.</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Дополнительные параметры</div><div class="admonitionContent_BuS1"><p>Для улучшенной обработки входной последовательности помимо её эмбеддинга можно передавать декодировщику дополнительную информацию, например, длину входной последовательности.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="окончание-генерации">Окончание генерации<a class="hash-link" aria-label="Прямая ссылка на Окончание генерации" title="Прямая ссылка на Окончание генерации" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#окончание-генерации">​</a></h3>
<p>В схемах one-to-many и many-to-many необходимо понять, когда следует останавливать генерацию выходной последовательности. Для этого существуют два подхода:</p>
<ul>
<li>
<p>генерировать выходы, пока не будет сгенерирован специальный токен [EOS], обозначающий конец генерации (end of sequence)</p>
</li>
<li>
<p>выделить отдельный выход сети, предсказывающий вероятность конца генерации; генерировать токены, пока вероятность окончания генерации не станет выше некоторого порога.</p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Neural-networks/Recurrent-neural-nets/Iterative-generation"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Итеративная генерация</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Neural-networks/Recurrent-neural-nets/Extensions"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Расширения</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#synchronized-many-to-many">Synchronized Many-to-Many</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#many-to-one">Many-to-One</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#one-to-many">One-to-Many</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#many-to-many">Many-to-Many</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/Neural-networks/Recurrent-neural-nets/Architectures#окончание-генерации">Окончание генерации</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2023-25 <a href="https://victorkitov.github.io/">Виктор Китов</a>.</div></div></div></footer></div>
</body>
</html>