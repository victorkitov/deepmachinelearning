<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Machine-learning/Base-concepts/Quality-estimation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Оценка качества прогнозов | Машинное и глубокое обучение</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://deepmachinelearning.ru/img/social-card2.png"><meta data-rh="true" name="twitter:image" content="https://deepmachinelearning.ru/img/social-card2.png"><meta data-rh="true" property="og:url" content="https://deepmachinelearning.ru/docs/Machine-learning/Base-concepts/Quality-estimation"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="keywords" content="машинное обучение, глубокое машинное обучение, анализ данных, machine learning, deep learning, data science обучение, искусственный интеллект, машинное обучение книги, машинное обучение курсы, методы прогнозирования"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Оценка качества прогнозов | Машинное и глубокое обучение"><meta data-rh="true" name="description" content="Оценка качества прогнозов алгоритмов машинного обучения. Подбор гиперпараметров моделей машинного обучения."><meta data-rh="true" property="og:description" content="Оценка качества прогнозов алгоритмов машинного обучения. Подбор гиперпараметров моделей машинного обучения."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://deepmachinelearning.ru/docs/Machine-learning/Base-concepts/Quality-estimation"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Machine-learning/Base-concepts/Quality-estimation" hreflang="ru"><link data-rh="true" rel="alternate" href="https://deepmachinelearning.ru/docs/Machine-learning/Base-concepts/Quality-estimation" hreflang="x-default"><link rel="preconnect" href="https://mc.yandex.ru">
<script>!function(e,t,a,c,n,r,i){e[n]=e[n]||function(){(e[n].a=e[n].a||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(a),i=t.getElementsByTagName(a)[0],r.async=1,r.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(r,i)}(window,document,"script",0,"ym"),ym(98444042,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!1,ecommerce:!1,trackHash:!1})</script>
<noscript>
                            <div><img src="https://mc.yandex.ru/watch/98444042" style="position:absolute; left:-9999px;" alt=""></div>
                        </noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1c01f2a4.css">
<script src="/assets/js/runtime~main.1a19b4f2.js" defer="defer"></script>
<script src="/assets/js/main.8d77c0b3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Machine-learning/book-title">Машинное обучение</a><a class="navbar__item navbar__link" href="/docs/Neural-networks/book-title">Глубокое обучение</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/abbreviations">Обозначения</a><a class="navbar__item navbar__link" href="/license">Лицензия</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Machine-learning/book-title">Машинное обучение</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Machine-learning/intro">Введение</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/Machine-learning/Base-concepts">Основы машинного обучения</a><button aria-label="Collapse sidebar category &#x27;Основы машинного обучения&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Supervised-learning">Обучение с учителем</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Function-selection">Настройка параметров модели</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Loss-convexity">Выпуклость потерь</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Regularization">Регуляризация модели</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Weighted-account">Взвешенный учёт наблюдений</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/MaxLikelihood-Connection">Связь с принципом максимального правдоподобия</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Generalization-ability">Обобщающая способность</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Machine-learning/Base-concepts/Quality-estimation">Оценка качества прогнозов</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Steps">Этапы решения задачи машинного обучения</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Unsupervised-learning">Обучение без учителя</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Semi-supervised-learning">Частичное обучение</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Machine-learning/Base-concepts/Questions">Вопросы</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Data-preprocessing">Подготовка данных</a><button aria-label="Expand sidebar category &#x27;Подготовка данных&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/General-classifiers">Классификаторы в общем виде</a><button aria-label="Expand sidebar category &#x27;Классификаторы в общем виде&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Metric-methods">Метрические методы прогнозирования</a><button aria-label="Expand sidebar category &#x27;Метрические методы прогнозирования&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Linear-regression-extensions">Линейная регрессия и её обобщения</a><button aria-label="Expand sidebar category &#x27;Линейная регрессия и её обобщения&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Regression-evaluation">Оценка качества регрессии</a><button aria-label="Expand sidebar category &#x27;Оценка качества регрессии&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Linear-classification">Линейная классификация</a><button aria-label="Expand sidebar category &#x27;Линейная классификация&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Multiclass-with-binary-classifiers">Многоклассовая классификация набором бинарных классификаторов</a><button aria-label="Expand sidebar category &#x27;Многоклассовая классификация набором бинарных классификаторов&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Numerical-optimization">Численная оптимизация</a><button aria-label="Expand sidebar category &#x27;Численная оптимизация&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Classifier-evaluation">Оценка качества классификации</a><button aria-label="Expand sidebar category &#x27;Оценка качества классификации&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Decision-trees">Решающие деревья</a><button aria-label="Expand sidebar category &#x27;Решающие деревья&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Overfitting-and-underfitting">Переобучение и недообучение</a><button aria-label="Expand sidebar category &#x27;Переобучение и недообучение&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Model-ensembles">Ансамбли моделей</a><button aria-label="Expand sidebar category &#x27;Ансамбли моделей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Boosting">Бустинг</a><button aria-label="Expand sidebar category &#x27;Бустинг&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Simple-models-interpretation">Интерпретация простых моделей</a><button aria-label="Expand sidebar category &#x27;Интерпретация простых моделей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Machine-learning/Complex-models-interpretation">Интерпретация сложных моделей</a><button aria-label="Expand sidebar category &#x27;Интерпретация сложных моделей&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Machine-learning/whats-next">Заключение</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Machine-learning/Base-concepts"><span itemprop="name">Основы машинного обучения</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Оценка качества прогнозов</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><h1>Оценка качества прогнозов</h1>
<p>Мы можем использовать для прогнозирования разные модели или одну и ту же модель, но при разных значениях гиперпараметров. Также для обработки варьируют весь <strong>конвейер обработки данных</strong> (пайплайн, pipeline), включающий как предобработку данных (заполнение пропущенных значений, отсев аномальных наблюдений, отбор и кодирование признаков), так и итоговое построение прогнозов. Важно уметь оценивать качество модели, чтобы подобрать самую точную модель и её наилучшую конфигурацию, а также знать, на какое качество работы мы можем рассчитывать на новых данных.</p>
<p>Как можно было бы оценить качество прогнозов модели? Как мы выяснили раньше, средние потери на обучающих объектах представляют собой необъективную и слишком оптимистическую оценку потерь модели на новых объектах, занижая потери, поскольку её параметры подбираются так, чтобы именно на обучающих объектах модель работала хорошо. Для более объективной оценки модел и есть два подхода - выделение отложенной <strong>валидационной выборки</strong> и <strong>кросс-валидация</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="отложенная-валидационная-выборка">Отложенная валидационная выборка<a class="hash-link" aria-label="Прямая ссылка на Отложенная валидационная выборка" title="Прямая ссылка на Отложенная валидационная выборка" href="/docs/Machine-learning/Base-concepts/Quality-estimation#отложенная-валидационная-выборка">​</a></h2>
<p>В этом подходе предлагается разбить размеченную выборку случайно на две подвыборки:</p>
<ul>
<li>
<p><strong>обучающую</strong> (training set, ~80% объектов), на которой настраивать параметры модели <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">w</mi></mrow><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf" style="margin-right:0.01597em">w</span></span></span></span>.</p>
</li>
<li>
<p><strong>валидационную</strong> (validation set, ~20% объектов), на которой оценивать её качество.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="train-val.png" src="/assets/images/train-val-60349149e2a7b3ab356d65c8e7e3461f.png" width="915" height="294" class="img_ev3q"></p>
<p>Таким образом, множество индексов всех объектов <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>N</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{1,2,...N\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">}</span></span></span></span> случайным образом разбивается на два подмножества:</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{train}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> - индексы объектов обучающей выборки</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{val}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> - индексы объектов валидационной выборки</p>
</li>
</ul>
<p>Настройка параметров производится по обучающим объектам (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>I</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|I|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord">∣</span></span></span></span> - число элементов в множестве <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span></span></span></span>):</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi mathvariant="bold">w</mi><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>Y</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><msub><mi>I</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>I</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></munder><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi mathvariant="bold">w</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>→</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant="bold">w</mi></munder></mrow><annotation encoding="application/x-tex">L(\mathbf{w}|X_{train},Y_{train})=\frac{1}{|I_{train}|}\sum_{i \in I_{train}}\mathcal{L}(f_{\mathbf{w}}(\mathbf{x}_{i}),\,y_{i}) \to \min_\mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em">w</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.7159em;vertical-align:-1.3944em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3679em;vertical-align:-0.7em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em"><span style="top:-2.4em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em">w</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em"><span></span></span></span></span></span></span></span></span></span>
<p>Также выше можно производить настройку с <a href="/docs/Machine-learning/Base-concepts/Regularization">регуляризацией</a>.</p>
<p>Оценка качества прогнозов производится по объектам валидационной выборки:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi mathvariant="bold">w</mi><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub><mo separator="true">,</mo><msub><mi>Y</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><msub><mi>I</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>I</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow></munder><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi mathvariant="bold">w</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(\mathbf{w}|X_{val},Y_{val})=\frac{1}{|I_{val}|}\sum_{i \in I_{val}}\mathcal{L}(f_{\mathbf{w}}(\mathbf{x}_{i}),\,y_{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em">w</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.7216em;vertical-align:-1.4002em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:-0.0785em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4002em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>В этом случае регуляризация не используется, т.к. нас интересует только точность итоговых прогнозов.</p>
<p>Данный подход также называется <strong>отложенным контролем</strong> (held-out data).</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Итоговая модель</div><div class="admonitionContent_BuS1"><p>После того, как мы оценили качество модели на валидационной выборке, итоговая модель обучается на всех размеченных данных (и на обучающей, и на валидационной выборке). Так мы повысим качество итоговой модели, настраивая её по всем располагаемым размеченным данным.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="кросс-валидация">Кросс-валидация<a class="hash-link" aria-label="Прямая ссылка на Кросс-валидация" title="Прямая ссылка на Кросс-валидация" href="/docs/Machine-learning/Base-concepts/Quality-estimation#кросс-валидация">​</a></h2>
<p>Недостатком отложенной валидационной выборки является то, что приходится обучать модель на подмножестве данных, а не на всех, поскольку часть данных резервируется на оценку качества (валидационную выборку). Валидационная выборка должна занимать существенную пропорцию от всех данных, чтобы репрезентативно представлять разнообразие новых наблюдений в будущем. Из-за этого тестируемая модель будет в общем получаться хуже, чем итоговая модель, которая обучается на всех данных.</p>
<p><strong>Кросс-валидация</strong> (перекрёстный контроль, кросс-проверка, cross-validation) - другой подход, который позволяет задействовать больше размеченных объектов для обучения, и все размеченные объекты для тестирования качества прогнозов, что обеспечивает более точное оценивание качества.</p>
<p>Для этого размеченная выборка  делится на K равных блоков (K обычно берется равным от 4 до 8). Далее каждый из этих блоков поочерёдно исключается, а модель настраивается по оставшимся блокам, как показано на рисунке:</p>
<p><img decoding="async" loading="lazy" alt="cross-validation.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYcAAAFpCAYAAAB3UOSMAAAAAXNSR0IArs4c6QAABRB0RVh0bXhmaWxlACUzQ214ZmlsZSUyMGhvc3QlM0QlMjJFbGVjdHJvbiUyMiUyMG1vZGlmaWVkJTNEJTIyMjAyMy0xMC0zMVQxMiUzQTA2JTNBMjUuNjQ0WiUyMiUyMGFnZW50JTNEJTIyNS4wJTIwKFgxMSUzQiUyMExpbnV4JTIweDg2XzY0KSUyMEFwcGxlV2ViS2l0JTJGNTM3LjM2JTIwKEtIVE1MJTJDJTIwbGlrZSUyMEdlY2tvKSUyMGRyYXcuaW8lMkYyMC44LjEwJTIwQ2hyb21lJTJGMTA2LjAuNTI0OS4xOTklMjBFbGVjdHJvbiUyRjIxLjMuNSUyMFNhZmFyaSUyRjUzNy4zNiUyMiUyMGV0YWclM0QlMjJJblhsWlJMVUdubUsxOHBYX21GWSUyMiUyMHZlcnNpb24lM0QlMjIyMC44LjEwJTIyJTIwdHlwZSUzRCUyMmRldmljZSUyMiUzRSUzQ2RpYWdyYW0lMjBuYW1lJTNEJTIyUGFnZS0xJTIyJTIwaWQlM0QlMjJrdVdEckFBWVhWdF9pYlphZ1U0NyUyMiUzRTNackxqcHN3RklhZmh1Vkl2bkR4TER0SjJxblVycUsybWxYRmdCTlFBVWVPVTVJOGZSMHdJVUJHbWtwRER2SEdzWCUyRmJHRDRmJTJCZkFyT0hTVzc3JTJGSWNKTjhGekhQSElMaXZVUG5EaUVZWTFmJTJGbkpTRFVSQUphbVV0MDlob3JiQk1qN3daYU5SZEd2TnRaNkFTSWxQcHBpdEdvaWg0cERwYUtLVW91OE5XSXV1dXVnblhmQ0Fzb3pBYnFyJTJGU1dDVzF5anpVNnM4OFhTZk55aGlabmp4c0JodGhtNFN4S0M4a3VuRG9UQXFoNmxxJTJCbiUyRkhzUkslMkZoVXMlMkY3JTJGRWJ2JTJCY1lrTDlSN0pqeThIT2tuOXB5ekk5c2RmJTJGd3VYcjclMkIlMkZQWmdydkkzekhibWdaMDVjcDRXVlltZE9YWVlyY3FnVXJ5cW5GY2xNMHI5Y09yUUVKTmlWOFQ4dENoeTZGT1pwSW92TjJGMDZpMTFrR2d0VVhtbVcxaFhWMm1XelVRbVpEV1h4aDVuc2F2MXJaTGlENyUyRm9ZZVNWJTJCcjd1TVRmTXBlTDdOMG5nTTE4ZG1WemtYTW1ESHRKTWFMYkVCQ1ZocGwyMk94d1lLYm5ZWE5kb29ZbXA5Zm5LTFhaZE1lVCUyRll4ZThLN3VnbVpPR3VhNWpvM3drN2RXSyUyQjFGMGpYWWNQTDRpOURHMFhYZGl0UDBoN2Z1UFllb0RVdzFzb0VyUXhLZ3lLNml5aVZGOXRJSHFtZUpVcURhdmJHTmhoVWxYOEZpdnZLUGRYN1QyODVWTG9MRVNHN0QyRXhZOFZtb0ZWalkxcks0TloycyUyRlpjRmp2ZUs4N2k5YSUyQnlrTEhxdVZGc3VGTnE3WVNvOEZqM1ZrazNXYnMzV1Fzc0N4V3VteXdMRTJoOUo5WXgya0xIQ3NWcm9zejRYR09yTEx1dEhaaXFhRzFVcVhCWTkxWkpjRms3TGdzVnJwc3VDeGp1eXlibk8yOWxPV2o2Q3hXdW15NExGYSUyQlZjV1BGWXJYUlk0Vm1xbHl4b1JxMjYybnpKVmZSZGZoTkhGUHclM0QlM0QlM0MlMkZkaWFncmFtJTNFJTNDJTJGbXhmaWxlJTNFPlJS9AAAHXpJREFUeF7t3XuwXWV5wOE3JKBFwMvoOFYHCiKGolhCQmhFEVoEGoKVKJEiFa0BRiW2FOXaQBJAQAgSasDgpSCgoqACCRclouMFSdR6g6AoIirD1EFQRAg4dM5mZKQ5O3uvvPvbK985D//oNHutvfaz3vX98u1DPRMWXH3Y4+GfUQXmzVw6AQ0BAmNX4LYLw/rX5fZOGInDrGlzx+7dX89PdsXKxSEO64nnMAKVCIzEYfKMVZVc7fAuc/WyqSEOXbzFYXiD6J0ItCUgDqPLi8M6JlIc2npcvS+B4QmIgzg0njZxaEzmAALVCYiDODQeWnFoTOYAAtUJiIM4NB5acWhM5gAC1QmIgzg0HlpxaEzmAALVCYiDODQeWnFoTOYAAtUJiIM4NB5acWhM5gAC1QmIgzg0HlpxaEzmAALVCYiDODQeWnFoTOYAAtUJiIM4NB5acWhM5gAC1QmIgzg0HlpxaEzmAALVCYjDEOKw6uZVcePyG+O2798WO++6cxx5zJHVDcqfX7A4VH37XDyBvgTEoXAcFh67MH72k7ti9712j8k7vDResv1L4tnPeXZfN2dDfZE4bKh3xnUR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" width="391" height="361" class="img_ev3q"></p>
<p>После прохода по всем блокам мы получим честные вневыборчные прогнозы для всех объектов, усреднением потерь на которых мы получим более точную оценку ожидаемых потерь для новых объектов. При этом, поскольку каждый раз исключается лишь один из небольших блоков, то тестируемая модель обучается на большем объеме данных и получается ближе к итоговой, которую мы обучаем на всей выборке.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Альтернативная итоговая модель</div><div class="admonitionContent_BuS1"><p>Вместо обучения итоговой модели на всех данных можно в качестве итоговой брать усреднение прогнозов по K моделям, обученных на каждом этапе кросс-валидации.</p><p>Такая конфигурация может показывать более высокую точность. Скорость обучения у неё больше (не нужно настраив ать модель сразу на всех данных), но скорость прогнозирования ниже (нужно каждый раз усреднять по K моделям).</p></div></div>
<p>Поскольку модель в кросс-валидации перенастраивается K раз, то можно исследовать стабильность потерь и стабильность настроенных параметров по отдельным блокам. Также можно следить за тем, насколько рассогласованными получаются прогнозы для тестовых данных по настроенным <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> моделям.</p>
<p>Недостатком кросс-валидации является то, что приходится K раз перенастраивать модель, в отличие от подхода с отложенной валидационной выборки, где тестируемая модель настраивалась лишь один раз.</p>
<p>В частном случае, когда K=N, модель будет применена к каждому объекту в отдельности. Такой метод называется <strong>скользящим
контролем</strong> (leave-one-out), но применяется только для моделей с очень быстрой настройкой, поскольку требует перенастройки модели N раз.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="особенности-применения-методов">Особенности применения методов<a class="hash-link" aria-label="Прямая ссылка на Особенности применения методов" title="Прямая ссылка на Особенности применения методов" href="/docs/Machine-learning/Base-concepts/Quality-estimation#особенности-применения-методов">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="случайное-перемешивание">Случайное перемешивание<a class="hash-link" aria-label="Прямая ссылка на Случайное перемешивание" title="Прямая ссылка на Случайное перемешивание" href="/docs/Machine-learning/Base-concepts/Quality-estimation#случайное-перемешивание">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Предобработка данных перед тестированием</div><div class="admonitionContent_BuS1"><p>Как перед применением подхода с отложенной выборкой, так и перед кросс-валидацией важно объекты перемешать <em>в случайном порядке</em>, поскольку исходный порядок объектов мог быть неслучайным, например, сначала могли идти простые, а потом более сложные для прогнозирования объе кты, что приведет к смещенной оценке качества прогнозов.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="стратифицированное-разбиение">Стратифицированное разбиение<a class="hash-link" aria-label="Прямая ссылка на Стратифицированное разбиение" title="Прямая ссылка на Стратифицированное разбиение" href="/docs/Machine-learning/Base-concepts/Quality-estimation#стратифицированное-разбиение">​</a></h3>
<p>Проблема при перемешивании может заключаться в том, что какие-то важные категориальные признаки или отклик (в задаче классификации) могут иметь несбалансированное распределение (одни категории или классы встречаются существенно чаще, чем другие, unbalanced classification). В этом случае целесообразно производить случайное разбиение на обучающую и валидационную выборку со стратификацией (stratified split), т.е. таким образом, чтобы распределение категорий после разбиения на подвыборки совпадало с исходным распределением на всей выборке, как для случая классов показано ниже:</p>
<p><img decoding="async" loading="lazy" alt="stratified split.png" src="/assets/images/stratified-split-39ebff80ee9784696bd9b45370ee8585.png" width="381" height="421" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="учет-случайности-результатов">Учет случайности результатов<a class="hash-link" aria-label="Прямая ссылка на Учет случайности результатов" title="Прямая ссылка на Учет случайности результатов" href="/docs/Machine-learning/Base-concepts/Quality-estimation#учет-случайности-результатов">​</a></h3>
<p>Поскольку разбиение на обучающие и валидационные блоки происходит случайно, то результаты могут различаться при перезапусках. Для воспроизводимости экспериментов важно зафиксировать случайный порядок. Это достигается инициализацией генератора случайных чисел фиксированным числом (random state). Если позволяют вычислительные ресурсы, рекомендуется перезапускать процедуру несколько раз с разной инициализацией, чтобы оценить влияние случайного разбиения на результат.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="анализ-результатов">Анализ результатов<a class="hash-link" aria-label="Прямая ссылка на Анализ результатов" title="Прямая ссылка на Анализ результатов" href="/docs/Machine-learning/Base-concepts/Quality-estimation#анализ-результатов">​</a></h2>
<p>Полученное качество можно визуализировать в виде сравнительной таблицы качества работы разных моделей или одной и той же модели, но при разных значениях гиперпараметров. В случае кросс-валидации полезно добавлять информацию о стандартном отклонении (standard deviation) оценки, полученной по разным блокам кросс-валидации.</p>
<p>Также информативно строить графики зависимости качества прогнозов от отдельного гиперпараметра (validation curve) и от размера обучающей выборки (learning curve), как показано ниже (<a href="https://scikit-learn.org/stable/modules/learning_curve.html#validation-curve" target="_blank" rel="noopener noreferrer">источник</a>):</p>
<p><img decoding="async" loading="lazy" src="/assets/images/val-curve_learning-curve-32c16737f3d873e88a47575a0188f59d.jpg" width="1163" height="532" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="подбор-гиперпараметров">Подбор гиперпараметров<a class="hash-link" aria-label="Прямая ссылка на Подбор гиперпараметров" title="Прямая ссылка на Подбор гиперпараметров" href="/docs/Machine-learning/Base-concepts/Quality-estimation#подбор-гиперпараметров">​</a></h2>
<p>С помощью валидационной выборки или кросс-валидации подбирают наилучшие гиперпараметры модели. Чаще всего гиперпараметры модели настраивают полным перебором по сетке значений (grid search) и выборов такой конфигурации, которая показывает наилучшее качество.</p>
<p>Вместо перебора по фиксированной сетке значений варианты гиперпараметров можно сэмплировать случайно из заданного диапазона (random search). Если настраивается не один, а сразу несколько гиперпараметров, когда среди гиперпараметров существуют как существенно, так и несущественно влияющие на функцию потерь, этот способ является более предпочтительным как обеспечивающий более разнообразный перебор значений для существенно влияющих параметров.</p>
<p>Существуют и более продвинутые способы перебора гиперпараметров, обеспечивающие за минимальное число проверок более быструю сходимость к наилучшей конфигурации (см. hyperparameter optimization).</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Оценка качества при одновременном подборе гиперпараметров</div><div class="admonitionContent_BuS1"><p>Если по валидационной выборке или кросс-валидации производилась настройка гиперпараметров, то использовать те же данные для итоговой оценки качества работы модели нельзя, так как при многократном переподборе значений гиперпараметров мы могли переобучиться, выбрав ту конфигурацию, которая хорошо работает именно на заданной валидационной выборке. Для несмещённой оценки качества подобранных гиперпараметров необходимо разбивать не на две, а на три выборки:</p><ul>
<li>
<p>обучающую (на которой настраиваем параметры модели)</p>
</li>
<li>
<p>валидационную (на которой настраиваем гиперпараметры модели)</p>
</li>
<li>
<p>тестовую (на которой уже тестируем качества итогового решения)</p>
</li>
</ul><p>Только ответы на отдельной тестовой выборке можно считать несмещенной в результате подбора гиперпараметров, поскольку только объекты этой выборки модель увидит в первый раз. Существует и кросс-валидационный подход многократного разбиения не на две, а на три подвыборки (nested cross-validation) для одновременного подбора гиперапаметров и оценки качества модели.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="оценка-качества-прогнозов-для-временных-рядов">Оценка качества прогнозов для временных рядов<a class="hash-link" aria-label="Прямая ссылка на Оценка качества прогнозов для временных рядов" title="Прямая ссылка на Оценка качества прогнозов для временных рядов" href="/docs/Machine-learning/Base-concepts/Quality-estimation#оценка-качества-прогнозов-для-временных-рядов">​</a></h2>
<p>Для оценки качества прогно зирования временных рядов (последовательности наблюдений, которые поступают динамически по времени) нельзя использовать обычные подходы, поскольку они приведут к случайному перемешиванию объектов во времени, и мы начнём тестировать качество прогнозов более ранних наблюдений по более поздним данным. Поэтому для временных рядов используется контроль по времени (out-of-time control), при котором усредняется качество прогнозов на один или несколько шагов вперед при всевозможных временных разбиениях на известные и будущие наблюдения, подлежащие прогнозированию, как показано на рисунке:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/out-of-time-control-bed4b6d1f3fe082a678628412c8f819d.png" width="368" height="422" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Machine-learning/Base-concepts/Generalization-ability"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Обобщающая способность</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Machine-learning/Base-concepts/Steps"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Этапы решения задачи машинного обучения</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#отложенная-валидационная-выборка">Отложенная валидационная выборка</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#кросс-валидация">Кросс-валидация</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#особенности-применения-методов">Особенности применения методов</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#случайное-перемешивание">Случайное перемешивание</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#стратифицированное-разбиение">Стратифицированное разбиение</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#учет-случайности-результатов">Учет случайности результатов</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#анализ-результатов">Анализ результатов</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#подбор-гиперпараметров">Подбор гиперпараметров</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Machine-learning/Base-concepts/Quality-estimation#оценка-качества-прогнозов-для-временны х-рядов">Оценка качества прогнозов для временных рядов</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2023-24 <a href="https://victorkitov.github.io/">Виктор Китов</a>.</div></div></div></footer></div>
</body>
</html>